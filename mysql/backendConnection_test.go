package mysql

import (
	"log"
	"testing"
)

func TestBackendConnectionReadInitialHanshake(t *testing.T) {

	/*
		backendConn, _ := NewBackendConnection(&AuthInfo{})

		data := []byte{
			0x36, 0x00, 0x00, 0x00, 0x0a, 0x35, 0x2e, 0x35, 0x2e, 0x32, 0x2d, 0x6d, 0x32, 0x00, 0x0b, 0x00,
			0x00, 0x00, 0x64, 0x76, 0x48, 0x40, 0x49, 0x2d, 0x43, 0x4a, 0x00, 0xff, 0xf7, 0x08, 0x02, 0x00,
			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x2a, 0x34, 0x64,
			0x7c, 0x63, 0x5a, 0x77, 0x6b, 0x34, 0x5e, 0x5d, 0x3a, 0x00,
		}

		backendConn.parseInitialHanshake(data)
		//	t.Errorf("%#v", backendConn)
	*/
	/*
		data := []byte{0xa, 0x35, 0x2e, 0x36, 0x2e, 0x33, 0x32, 0x0, 0xf, 0x0, 0x0, 0x0, 0x34, 0x5a, 0x4b, 0x46, 0x5c, 0x7e, 0x25, 0x3a, 0x0, 0xff, 0xf7, 0x8, 0x2, 0x0, 0x7f, 0x80, 0x15, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x33, 0x32, 0x40, 0x2d, 0x5c, 0x6b, 0x25, 0x72, 0x31, 0x3c, 0x78, 0x68, 0x0, 0x6d, 0x79, 0x73, 0x71, 0x6c, 0x5f, 0x6e, 0x61, 0x74, 0x69, 0x76, 0x65, 0x5f, 0x70, 0x61, 0x73, 0x73, 0x77, 0x6f, 0x72, 0x64, 0x0}

		backendConn, _ := NewBackendConnection(&AuthInfo{})

		backendConn.parseInitialHanshake(data)
		t.Errorf("%#v", backendConn)
	*/

	backendConnection, err := NewBackendConnection("127.0.0.1:3006", &AuthInfo{User: "root", Password: "root"}, "")

	if err != nil {
		t.Error(err)
		return
	}

	ret, err := backendConnection.ComQuery("use mysql;")

	for _, v := range ret.Rows {
		log.Println(string(v))
	}

	ret, err = backendConnection.ComQuery("show tables;")

	for _, v := range ret.Rows {
		log.Println(string(v))
	}

	t.Error(ret, err)

}
